{"version":3,"sources":["UserCache.es6"],"names":["UserCache","addEvents","rows","document","querySelectorAll","row","querySelector","addEventListener","viewData","bind","deleteData","evt","preventDefault","dataDiv","target","nextElementSibling","promise","Promise","resolve","reject","getAttribute","Rest","getJSON","href","then","appendChild","JsonHuman","format","response","data","setAttribute","catch","console","log","error","basicModal","show","body","buttons","cancel","title","fn","close","action","deleted","notifier","usercache","init"],"mappings":";;;;;;AAAA;;IAEMA,S;;;;;;;+BACK;AACH,iBAAKC,SAAL;AACH;;;oCAEW;AACR,gBAAIC,OAAOC,SAASC,gBAAT,CAA0B,UAA1B,CAAX;AADQ;AAAA;AAAA;;AAAA;AAER,qCAAgBF,IAAhB,8HAAsB;AAAA,wBAAbG,GAAa;;AAClBA,wBAAIC,aAAJ,CAAkB,QAAlB,EAA4BC,gBAA5B,CAA6C,OAA7C,EAAsD,KAAKC,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAAtD;AACAJ,wBAAIC,aAAJ,CAAkB,UAAlB,EAA8BC,gBAA9B,CAA+C,OAA/C,EAAwD,KAAKG,UAAL,CAAgBD,IAAhB,CAAqB,IAArB,CAAxD;AACH;AALO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMX;;;iCAEQE,G,EAAK;AACVA,gBAAIC,cAAJ;AACA,gBAAIC,UAAUF,IAAIG,MAAJ,CAAWC,kBAAzB;AACA,gBAAIC,UAAU,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC3CD;AACH,aAFa,CAAd;AAGA,gBAAIL,QAAQO,YAAR,CAAqB,aAArB,MAAwC,QAA5C,EAAsD;AAClDJ,0BAAUK,KAAKC,OAAL,CAAaX,IAAIG,MAAJ,CAAWS,IAAxB,EAA8BC,IAA9B,CAAmC,oBAAY;AACrDX,4BAAQY,WAAR,CAAoBC,UAAUC,MAAV,CAAiBC,SAASC,IAA1B,CAApB;AACAhB,4BAAQiB,YAAR,CAAqB,aAArB,EAAoC,QAApC;AACH,iBAHS,CAAV;AAIH;AACDd,oBAAQQ,IAAR,CAAa,YAAM;AACfX,wBAAQiB,YAAR,CAAqB,YAArB,EAAmCjB,QAAQO,YAAR,CAAqB,YAArB,MAAuC,OAAvC,GAAiD,QAAjD,GAA4D,OAA/F;AACH,aAFD,EAEGW,KAFH,CAES,iBAAS;AACdC,wBAAQC,GAAR,CAAYC,KAAZ;AACH,aAJD;AAKH;;;mCAEUvB,G,EAAK;AACZA,gBAAIC,cAAJ;AACAuB,uBAAWC,IAAX,CAAgB;AACZC,sBAAM,sBADM;AAEZC,yBAAS;AACLC,4BAAQ;AACJC,+BAAO,QADH;AAEJC,4BAAIN,WAAWO;AAFX,qBADH;AAKLC,4BAAQ;AACJH,+BAAO,UADH;AAEJC,4BAAI,cAAM;AACNN,uCAAWO,KAAX;AACArB,iCAAKC,OAAL,CAAaX,IAAIG,MAAJ,CAAWS,IAAxB,EAA8BC,IAA9B,CAAmC,oBAAY;AAC3C,oCAAII,SAASgB,OAAT,KAAqB,IAAzB,EAA+B;AAC3BC,6CAAST,IAAT,CAAc,SAAd,EAAyB,yBAAzB,EAAoD,SAApD,EAA+D,EAA/D,EAAmE,IAAnE;AACH,iCAFD,MAEO;AACHS,6CAAST,IAAT,CACI,QADJ,EAEI,6BAFJ,EAGI,QAHJ,EAII,gDAJJ,EAKI,IALJ;AAOH;AACJ,6BAZD;AAaH;AAjBG;AALH;AAFG,aAAhB;AA4BH;;;;;;AAGL,IAAIU,YAAY,IAAI9C,SAAJ,EAAhB;AACA8C,UAAUC,IAAV","file":"UserCache.js","sourcesContent":["/* global document,Rest,JsonHuman,basicModal,notifier */\n\nclass UserCache {\n    init() {\n        this.addEvents();\n    }\n\n    addEvents() {\n        let rows = document.querySelectorAll('tbody tr');\n        for (let row of rows) {\n            row.querySelector('a.view').addEventListener('click', this.viewData.bind(this));\n            row.querySelector('a.delete').addEventListener('click', this.deleteData.bind(this));\n        }\n    }\n\n    viewData(evt) {\n        evt.preventDefault();\n        let dataDiv = evt.target.nextElementSibling;\n        let promise = new Promise((resolve, reject) => {\n            resolve();\n        });\n        if (dataDiv.getAttribute('data-cached') !== 'cached') {\n            promise = Rest.getJSON(evt.target.href).then(response => {\n                dataDiv.appendChild(JsonHuman.format(response.data));\n                dataDiv.setAttribute('data-cached', 'cached');\n            });\n        }\n        promise.then(() => {\n            dataDiv.setAttribute('data-state', dataDiv.getAttribute('data-state') === 'shown' ? 'hidden' : 'shown');\n        }).catch(error => {\n            console.log(error);\n        });\n    }\n\n    deleteData(evt) {\n        evt.preventDefault();\n        basicModal.show({\n            body: '<p>Are you sure?</p>',\n            buttons: {\n                cancel: {\n                    title: 'Cancel',\n                    fn: basicModal.close\n                },\n                action: {\n                    title: 'Continue',\n                    fn: () => {\n                        basicModal.close();\n                        Rest.getJSON(evt.target.href).then(response => {\n                            if (response.deleted === true) {\n                                notifier.show('Deleted', 'Entry has been deleted ', 'success', '', 2000);\n                            } else {\n                                notifier.show(\n                                    'Error!',\n                                    'Maybe the key was incorrect',\n                                    'danger',\n                                    '/bundles/dhservidores/img/high_priority-48.png',\n                                    2000\n                                );\n                            }\n                        });\n                    }\n                }\n            }\n        });\n    }\n}\n\nlet usercache = new UserCache();\nusercache.init();\n"]}